import"../chunks/DsnmJJEf.js";import{D as ds,p as cs,E as aa,F as _s,o as us,f as b,z as sa,c as k,a as p,b as ps,j as O,g as e,h as s,r as a,s as t,G as ya,H as Ka,t as fa,l as v,I as Wa,J as Xa,K as ma,q as ws,y as Ya}from"../chunks/C5jdwYbG.js";import"../chunks/CanLVora.js";import{f as y,a as Za}from"../chunks/Be5qoVR8.js";var fs=b('<div class="loading-container svelte-il4wsa"><div class="spinner svelte-il4wsa"></div> <p class="svelte-il4wsa">Cargando cr√©ditos...</p></div>'),ms=b('<div class="empty-state svelte-il4wsa"><p class="svelte-il4wsa">No hay cr√©ditos que coincidan con los filtros</p></div>'),bs=b('<button class="btn-estado vencido svelte-il4wsa">Marcar Vencido</button> <button class="btn-estado pagado svelte-il4wsa">Marcar Pagado</button>',1),gs=b('<button class="btn-estado activo svelte-il4wsa">Reactivar</button>'),hs=b('<div><div class="credit-header svelte-il4wsa"><div class="credit-info svelte-il4wsa"><h3 class="svelte-il4wsa"> </h3> <p class="client-name svelte-il4wsa"> </p></div> <div class="credit-status svelte-il4wsa"><span> </span></div></div> <div class="credit-details svelte-il4wsa"><div class="detail-row svelte-il4wsa"><span class="label svelte-il4wsa">Monto Total:</span> <span class="value svelte-il4wsa"> </span></div> <div class="detail-row svelte-il4wsa"><span class="label svelte-il4wsa">Saldo Pendiente:</span> <span class="value svelte-il4wsa"> </span></div> <div class="detail-row svelte-il4wsa"><span class="label svelte-il4wsa">Cuotas:</span> <span class="value svelte-il4wsa"> </span></div> <div class="detail-row svelte-il4wsa"><span class="label svelte-il4wsa">Desembolso:</span> <span class="value svelte-il4wsa"> </span></div></div> <div class="credit-actions svelte-il4wsa"><button class="btn-detalle svelte-il4wsa">Ver Detalle</button> <div class="state-actions svelte-il4wsa"><!></div></div></div>'),Ds=b('<div class="credits-list svelte-il4wsa"></div>'),As=b('<div class="stats-header svelte-il4wsa"><h1 class="svelte-il4wsa">Gesti√≥n de Cr√©ditos</h1> <div class="stats-grid svelte-il4wsa"><div class="stat-card svelte-il4wsa"><div class="stat-value svelte-il4wsa"> </div> <div class="stat-label svelte-il4wsa">Total Cr√©ditos</div></div> <div class="stat-card svelte-il4wsa"><div class="stat-value svelte-il4wsa"> </div> <div class="stat-label svelte-il4wsa">Activos</div></div> <div class="stat-card svelte-il4wsa"><div class="stat-value svelte-il4wsa"> </div> <div class="stat-label svelte-il4wsa">Saldo Pendiente</div></div> <div class="stat-card alert svelte-il4wsa"><div class="stat-value svelte-il4wsa"> </div> <div class="stat-label svelte-il4wsa">Cuotas Vencidas</div></div></div></div> <div class="filters-section svelte-il4wsa"><div class="filters-row svelte-il4wsa"><div class="filter-group svelte-il4wsa"><label for="filtro-estado" class="svelte-il4wsa">Estado:</label> <select id="filtro-estado" class="svelte-il4wsa"><option class="svelte-il4wsa">Todos</option><option class="svelte-il4wsa">Activos</option><option class="svelte-il4wsa">Vencidos</option><option class="svelte-il4wsa">Pagados</option></select></div> <div class="filter-group svelte-il4wsa"><label for="filtro-frecuencia" class="svelte-il4wsa">Frecuencia:</label> <select id="filtro-frecuencia" class="svelte-il4wsa"><option class="svelte-il4wsa">Todas</option><option class="svelte-il4wsa">Diario</option><option class="svelte-il4wsa">Semanal</option><option class="svelte-il4wsa">Quincenal</option><option class="svelte-il4wsa">Mensual</option></select></div></div></div> <div class="credits-section svelte-il4wsa"><!></div>',1),Cs=b('<span class="dias-atraso svelte-il4wsa"> </span>'),xs=b('<tr><td class="svelte-il4wsa"> </td><td class="svelte-il4wsa"> </td><td class="svelte-il4wsa"> </td><td class="svelte-il4wsa"> </td><td class="svelte-il4wsa"><span> </span></td><td class="svelte-il4wsa"><!></td></tr>'),Es=b('<button class="btn-action vencido svelte-il4wsa">Marcar como Vencido</button> <button class="btn-action pagado svelte-il4wsa">Marcar como Pagado</button>',1),Os=b('<button class="btn-action activo svelte-il4wsa">Reactivar Cr√©dito</button>'),Vs=b('<div class="modal-backdrop svelte-il4wsa" role="dialog"><div class="modal-content svelte-il4wsa"><div class="modal-header svelte-il4wsa"><h2 class="svelte-il4wsa"> </h2> <button class="btn-close svelte-il4wsa">‚úï</button></div> <div class="modal-body svelte-il4wsa"><div class="credit-info-section svelte-il4wsa"><h3 class="svelte-il4wsa">Informaci√≥n General</h3> <div class="info-grid svelte-il4wsa"><div class="info-item svelte-il4wsa"><span class="info-label svelte-il4wsa">Cliente:</span> <span class="info-value svelte-il4wsa"> </span></div> <div class="info-item svelte-il4wsa"><span class="info-label svelte-il4wsa">N√∫mero:</span> <span class="info-value svelte-il4wsa"> </span></div> <div class="info-item svelte-il4wsa"><span class="info-label svelte-il4wsa">Estado:</span> <span> </span></div> <div class="info-item svelte-il4wsa"><span class="info-label svelte-il4wsa">Frecuencia:</span> <span class="info-value svelte-il4wsa"> </span></div> <div class="info-item svelte-il4wsa"><span class="info-label svelte-il4wsa">Monto Total:</span> <span class="info-value svelte-il4wsa"> </span></div> <div class="info-item svelte-il4wsa"><span class="info-label svelte-il4wsa">Saldo Pendiente:</span> <span class="info-value svelte-il4wsa"> </span></div> <div class="info-item svelte-il4wsa"><span class="info-label svelte-il4wsa">Valor Cuota:</span> <span class="info-value svelte-il4wsa"> </span></div> <div class="info-item svelte-il4wsa"><span class="info-label svelte-il4wsa">Progreso:</span> <span class="info-value svelte-il4wsa"> </span></div></div></div> <div class="schedule-section svelte-il4wsa"><h3 class="svelte-il4wsa">Cronograma de Pagos</h3> <div class="schedule-table svelte-il4wsa"><table class="svelte-il4wsa"><thead class="svelte-il4wsa"><tr class="svelte-il4wsa"><th class="svelte-il4wsa">#</th><th class="svelte-il4wsa">Fecha</th><th class="svelte-il4wsa">Monto</th><th class="svelte-il4wsa">Pagado</th><th class="svelte-il4wsa">Estado</th><th class="svelte-il4wsa">Atraso</th></tr></thead><tbody class="svelte-il4wsa"></tbody></table></div></div> <div class="credit-actions-section svelte-il4wsa"><h3 class="svelte-il4wsa">Acciones</h3> <div class="actions-grid svelte-il4wsa"><!> <button class="btn-action pago svelte-il4wsa">Registrar Pago</button></div></div></div></div></div>'),Is=b('<div class="credit-management-page svelte-il4wsa"><!></div> <!>',1);function Ps(as,ss){cs(ss,!0);let Na=aa(!0),C=aa(_s([])),ba=aa("TODOS"),ga=aa("TODOS"),n=aa(null),Pa=aa(!1),ha=Ka(()=>{const l={totalCreditos:e(C).length,creditosActivos:e(C).filter(r=>r.estado==="ACTIVO").length,creditosVencidos:e(C).filter(r=>r.estado==="VENCIDO").length,montoTotal:e(C).reduce((r,u)=>r+(u.total_a_pagar||0),0),saldoPendiente:e(C).reduce((r,u)=>r+(u.saldo_pendiente||0),0),cuotasVencidas:0,proximosVencimientos:0},o=new Date,i=new Date(o);return i.setDate(i.getDate()+1),e(C).forEach(r=>{Ha(r).forEach(g=>{const x=new Date(g.fecha_programada);g.estado!=="PAGADA"&&(x<o?l.cuotasVencidas++:x<=i&&l.proximosVencimientos++)})}),l}),Ba=Ka(()=>{let l=[...e(C)];return e(ba)!=="TODOS"&&(l=l.filter(o=>o.estado===e(ba))),e(ga)!=="TODOS"&&(l=l.filter(o=>o.frecuencia===e(ga))),l});us(async()=>{await es()});async function es(){try{O(Na,!0);const l=[];O(C,[],!0),console.log("üí≥ [BALANCE] Cr√©ditos cargados:",e(C).length)}catch(l){console.error("Error cargando cr√©ditos:",l)}finally{O(Na,!1)}}function ts(l){O(n,l,!0),O(Pa,!0)}function Sa(){O(Pa,!1),O(n,null)}async function U(l,o){try{console.log("üîÑ [BALANCE] Cambiando estado:",l.numero_credito,o),alert(`Cambiar estado de ${l.numero_credito} a ${o}
(Funcionalidad ser√° implementada con @sync/core)`)}catch(i){console.error("Error cambiando estado:",i)}}function Ma(l){return l.dias_atraso>0?"mora":l.estado==="VENCIDO"?"vencido":l.estado==="PAGADO"?"pagado":"activo"}function za(l){return l.dias_atraso>0?`MORA (${l.dias_atraso}d)`:l.estado}function Ha(l){const o=[];let i=new Date(l.fecha_primera_cuota+"T12:00:00");for(let r=1;r<=l.numero_cuotas;r++){const u=r<=l.cuotas_pagadas,g=i.toISOString().split("T")[0],x=new Date().toISOString().split("T")[0],V=!u&&g<x?Math.floor((new Date(x)-new Date(g))/(1e3*60*60*24)):0;switch(o.push({numero:r,fecha_programada:g,monto_programado:l.valor_cuota,monto_pagado:u?l.valor_cuota:0,estado:u?"PAGADA":"PENDIENTE",dias_atraso:V}),l.frecuencia){case"DIARIO":i.setDate(i.getDate()+1),l.excluir_domingos&&i.getDay()===0&&i.setDate(i.getDate()+1);break;case"SEMANAL":i.setDate(i.getDate()+7);break;case"QUINCENAL":i.setDate(i.getDate()+15);break;case"MENSUAL":i.setMonth(i.getMonth()+1);break}}return o}var Ja=Is(),La=sa(Ja),ls=s(La);{var is=l=>{var o=fs();p(l,o)},vs=l=>{var o=As(),i=sa(o),r=t(s(i),2),u=s(r),g=s(u),x=s(g,!0);a(g),ya(2),a(u);var V=t(u,2),Q=s(V),Da=s(Q,!0);a(Q),ya(2),a(V);var N=t(V,2),ea=s(N),Fa=s(ea,!0);a(ea),ya(2),a(N);var q=t(N,2),ta=s(q),Ga=s(ta,!0);a(ta),ya(2),a(q),a(r),a(i);var P=t(i,2),B=s(P),la=s(B),S=t(s(la),2),z=s(S);z.value=z.__value="TODOS";var ia=t(z);ia.value=ia.__value="ACTIVO";var M=t(ia);M.value=M.__value="VENCIDO";var va=t(M);va.value=va.__value="PAGADO",a(S),a(la);var Aa=t(la,2),L=t(s(Aa),2),H=s(L);H.value=H.__value="TODOS";var oa=t(H);oa.value=oa.__value="DIARIO";var F=t(oa);F.value=F.__value="SEMANAL";var J=t(F);J.value=J.__value="QUINCENAL";var Ca=t(J);Ca.value=Ca.__value="MENSUAL",a(L),a(Aa),a(B),a(P);var ra=t(P,2),xa=s(ra);{var Ra=w=>{var I=ms();p(w,I)},na=w=>{var I=Ds();Xa(I,21,()=>e(Ba),K=>K.id,(K,d)=>{var G=hs(),W=s(G),da=s(W),ca=s(da),ja=s(ca,!0);a(ca);var c=t(ca,2),_=s(c,!0);a(c),a(da);var f=t(da,2),m=s(f),E=s(m,!0);a(m),a(f),a(W);var D=t(W,2),_a=s(D),X=t(s(_a),2),$a=s(X,!0);a(X),a(_a);var R=t(_a,2),Ea=t(s(R),2),ua=s(Ea,!0);a(Ea),a(R);var j=t(R,2),Oa=t(s(j),2),Va=s(Oa);a(Oa),a(j);var Ia=t(j,2),Ta=t(s(Ia),2),Ua=s(Ta,!0);a(Ta),a(Ia),a(D);var h=t(D,2),A=s(h);A.__click=()=>ts(e(d));var Y=t(A,2),Qa=s(Y);{var qa=T=>{var $=bs(),Z=sa($);Z.__click=()=>U(e(d),"VENCIDO");var pa=t(Z,2);pa.__click=()=>U(e(d),"PAGADO"),p(T,$)},ns=T=>{var $=Ya(),Z=sa($);{var pa=wa=>{var ka=gs();ka.__click=()=>U(e(d),"ACTIVO"),p(wa,ka)};k(Z,wa=>{e(d).estado==="VENCIDO"&&wa(pa)},!0)}p(T,$)};k(Qa,T=>{e(d).estado==="ACTIVO"?T(qa):T(ns,!1)})}a(Y),a(h),a(G),fa((T,$,Z,pa,wa,ka)=>{ma(G,1,`credit-card ${T??""}`,"svelte-il4wsa"),v(ja,e(d).numero_credito),v(_,e(d).cliente_nombre),ma(m,1,`status-badge ${$??""}`,"svelte-il4wsa"),v(E,Z),v($a,pa),v(ua,wa),v(Va,`${e(d).cuotas_pagadas??""}/${e(d).numero_cuotas??""} (${e(d).frecuencia??""})`),v(Ua,ka)},[()=>Ma(e(d)),()=>Ma(e(d)),()=>za(e(d)),()=>y(e(d).total_a_pagar),()=>y(e(d).saldo_pendiente),()=>Za(e(d).fecha_desembolso)]),p(K,G)}),a(I),p(w,I)};k(xa,w=>{e(Ba).length===0?w(Ra):w(na,!1)})}a(ra),fa(w=>{v(x,e(ha).totalCreditos),v(Da,e(ha).creditosActivos),v(Fa,w),v(Ga,e(ha).cuotasVencidas)},[()=>y(e(ha).saldoPendiente)]),Wa(S,()=>e(ba),w=>O(ba,w)),Wa(L,()=>e(ga),w=>O(ga,w)),p(l,o)};k(ls,l=>{e(Na)?l(is):l(vs,!1)})}a(La);var os=t(La,2);{var rs=l=>{var o=Vs();o.__click=Sa,o.__keydown=c=>c.key==="Escape"&&Sa();var i=s(o);i.__click=c=>c.stopPropagation();var r=s(i),u=s(r),g=s(u);a(u);var x=t(u,2);x.__click=Sa,a(r);var V=t(r,2),Q=s(V),Da=t(s(Q),2),N=s(Da),ea=t(s(N),2),Fa=s(ea,!0);a(ea),a(N);var q=t(N,2),ta=t(s(q),2),Ga=s(ta,!0);a(ta),a(q);var P=t(q,2),B=t(s(P),2),la=s(B,!0);a(B),a(P);var S=t(P,2),z=t(s(S),2),ia=s(z,!0);a(z),a(S);var M=t(S,2),va=t(s(M),2),Aa=s(va,!0);a(va),a(M);var L=t(M,2),H=t(s(L),2),oa=s(H,!0);a(H),a(L);var F=t(L,2),J=t(s(F),2),Ca=s(J,!0);a(J),a(F);var ra=t(F,2),xa=t(s(ra),2),Ra=s(xa);a(xa),a(ra),a(Da),a(Q);var na=t(Q,2),w=t(s(na),2),I=s(w),K=t(s(I));Xa(K,21,()=>Ha(e(n)),c=>c.numero,(c,_)=>{var f=xs(),m=s(f),E=s(m,!0);a(m);var D=t(m),_a=s(D,!0);a(D);var X=t(D),$a=s(X,!0);a(X);var R=t(X),Ea=s(R,!0);a(R);var ua=t(R),j=s(ua),Oa=s(j,!0);a(j),a(ua);var Va=t(ua),Ia=s(Va);{var Ta=h=>{var A=Cs(),Y=s(A);a(A),fa(()=>v(Y,`${e(_).dias_atraso??""} d√≠as`)),p(h,A)},Ua=h=>{var A=ws("-");p(h,A)};k(Ia,h=>{e(_).dias_atraso>0?h(Ta):h(Ua,!1)})}a(Va),a(f),fa((h,A,Y,Qa,qa)=>{ma(f,1,`cuota-row ${h??""}`,"svelte-il4wsa"),v(E,e(_).numero),v(_a,A),v($a,Y),v(Ea,Qa),ma(j,1,`cuota-estado ${qa??""}`,"svelte-il4wsa"),v(Oa,e(_).estado)},[()=>e(_).estado.toLowerCase(),()=>Za(e(_).fecha_programada),()=>y(e(_).monto_programado),()=>y(e(_).monto_pagado),()=>e(_).estado.toLowerCase()]),p(c,f)}),a(K),a(I),a(w),a(na);var d=t(na,2),G=t(s(d),2),W=s(G);{var da=c=>{var _=Es(),f=sa(_);f.__click=()=>U(e(n),"VENCIDO");var m=t(f,2);m.__click=()=>U(e(n),"PAGADO"),p(c,_)},ca=c=>{var _=Ya(),f=sa(_);{var m=E=>{var D=Os();D.__click=()=>U(e(n),"ACTIVO"),p(E,D)};k(f,E=>{e(n).estado==="VENCIDO"&&E(m)},!0)}p(c,_)};k(W,c=>{e(n).estado==="ACTIVO"?c(da):c(ca,!1)})}var ja=t(W,2);ja.__click=()=>alert("Funcionalidad de registrar pago pr√≥ximamente"),a(G),a(d),a(V),a(i),a(o),fa((c,_,f,m,E)=>{v(g,`Detalle del Cr√©dito ${e(n).numero_credito??""}`),v(Fa,e(n).cliente_nombre),v(Ga,e(n).numero_credito),ma(B,1,`info-value status-badge ${c??""}`,"svelte-il4wsa"),v(la,_),v(ia,e(n).frecuencia),v(Aa,f),v(oa,m),v(Ca,E),v(Ra,`${e(n).cuotas_pagadas??""}/${e(n).numero_cuotas??""} cuotas`)},[()=>Ma(e(n)),()=>za(e(n)),()=>y(e(n).total_a_pagar),()=>y(e(n).saldo_pendiente),()=>y(e(n).valor_cuota)]),p(l,o)};k(os,l=>{e(Pa)&&e(n)&&l(rs)})}p(as,Ja),ps()}ds(["click","keydown"]);export{Ps as component};
