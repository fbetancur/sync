const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/RPnKBoCH.js","../chunks/PPVm8Dsz.js"])))=>i.map(i=>d[i]);
import{_ as te}from"../chunks/PPVm8Dsz.js";import"../chunks/DsnmJJEf.js";import{D as se,p as ie,o as re,y as ce,z as A,c as j,a as S,b as le,A as ve,B as E,f as W,h as r,g as e,H as x,r as c,s as n,C as ue,t as L,K as g,l as P}from"../chunks/C5jdwYbG.js";import{p as de}from"../chunks/Dx07nh2P.js";import{g as $}from"../chunks/Dj_5MnEQ.js";import{u as ge,a as me}from"../chunks/Bfzz_jm3.js";import{i as pe}from"../chunks/DhBo1QyW.js";import"../chunks/CanLVora.js";let C=!1,O=null,H=0;const fe=300*1e3,ke=5e4;function he(){C||console.log("üë§ [SYNC] Usuario activo - pausando sincronizaci√≥n autom√°tica"),C=!0,clearTimeout(O),O=setTimeout(()=>{C=!1,console.log("üí§ [SYNC] Usuario inactivo (50s) - reanudando sincronizaci√≥n"),navigator.onLine&&m()},ke)}async function m(a=!1){const v=Date.now()-H;if(a)console.log("üöÄ [SYNC] Sincronizaci√≥n FORZADA - ignorando todas las restricciones");else{if(v>=fe&&(console.log("‚è∞ [SYNC] Sync forzado (5 min transcurridos) - ignorando actividad del usuario"),a=!0),C&&!a){console.log("‚è∏Ô∏è [SYNC] Usuario activo - sincronizaci√≥n pospuesta");return}if(!a&&v<3e4){console.log(`‚è≠Ô∏è [SYNC] Sincronizaci√≥n reciente (hace ${Math.round(v/1e3)}s) - saltando`);return}}const w=Date.now();console.log("üîÑ [SYNC] Iniciando sincronizaci√≥n usando @sync/core...");try{console.log("üîÑ [SYNC] Simulando sincronizaci√≥n con @sync/core..."),await new Promise(f=>setTimeout(f,100));const t=Date.now()-w;return H=Date.now(),console.log(`‚úÖ [SYNC] Simulaci√≥n completada en ${t}ms`),{success:!0,elapsed:t,synced:0,errors:0}}catch(t){throw console.error("‚ùå [SYNC] Error cr√≠tico en sincronizaci√≥n global:",t),t}}{console.log("üöÄ [SYNC] Iniciando sincronizaci√≥n autom√°tica global con @sync/core...");const a=["scroll","mousemove","mousedown","touchstart","touchmove","keydown","click","input"];a.forEach(p=>{document.addEventListener(p,he,{passive:!0})}),console.log("üëÇ [SYNC] Detectores de actividad configurados:",a.join(", ")),setInterval(()=>{navigator.onLine&&m()},3e4),window.addEventListener("online",()=>{console.log("üì° [SYNC] Conexi√≥n restaurada - sincronizando (forzado)"),m(!0)}),document.addEventListener("visibilitychange",()=>{!document.hidden&&navigator.onLine&&(console.log("üëÅÔ∏è [SYNC] App visible - sincronizando (forzado)"),m(!0))}),window.addEventListener("focus",()=>{navigator.onLine&&(console.log("üéØ [SYNC] App enfocada - sincronizando (forzado)"),m(!0))}),setTimeout(()=>{console.log("‚è∞ [SYNC] Sincronizaci√≥n inicial (forzado)"),m(!0)},2e3),console.log("‚úÖ [SYNC] Sincronizaci√≥n autom√°tica configurada con @sync/core"),console.log("‚öôÔ∏è [SYNC] Configuraci√≥n:"),console.log("   ‚Ä¢ Intervalo peri√≥dico: 30s (respeta actividad)"),console.log("   ‚Ä¢ Inactividad requerida: 50s"),console.log("   ‚Ä¢ Sync forzado m√°ximo: 5 min (ignora actividad)"),console.log("   ‚Ä¢ Eventos que pausan sync:",a.length)}var _e=W('<button class="back-btn svelte-1v2axqk"><svg class="icon svelte-1v2axqk" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <h1 class="section-title svelte-1v2axqk"> </h1> <div></div>',1),be=W('<span class="app-name svelte-1v2axqk">CrediSync</span> <div></div> <h1 class="section-title svelte-1v2axqk"> </h1>',1),Se=W('<div class="app-container svelte-1v2axqk"><header class="app-header svelte-1v2axqk"><div class="header-content svelte-1v2axqk"><div class="header-left svelte-1v2axqk"><!></div> <div class="header-right svelte-1v2axqk"><button class="logout-btn svelte-1v2axqk" title="Cerrar sesi√≥n"><svg class="icon svelte-1v2axqk" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg></button></div></div></header> <main class="app-main svelte-1v2axqk"><!></main> <nav class="bottom-nav svelte-1v2axqk"><button><svg class="nav-icon svelte-1v2axqk" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path></svg> <span class="nav-label svelte-1v2axqk">Mi Ruta</span></button> <button><svg class="nav-icon svelte-1v2axqk" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> <span class="nav-label svelte-1v2axqk">Clientes</span></button> <button><svg class="nav-icon svelte-1v2axqk" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span class="nav-label svelte-1v2axqk">Balance</span></button> <button><svg class="nav-icon svelte-1v2axqk" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg> <span class="nav-label svelte-1v2axqk">Configuraci√≥n</span></button></nav></div>');function Me(a,p){ie(p,!0);const v=()=>E(ge,"$user",f),w=()=>E(de,"$page",f),t=()=>E(pe,"$isOnline",f),[f,U]=ve();re(async()=>{v()||$("/login");try{{const{registerSW:o}=await te(async()=>{const{registerSW:i}=await import("../chunks/RPnKBoCH.js");return{registerSW:i}},__vite__mapDeps([0,1]),import.meta.url),k=o({onNeedRefresh(){console.log("üîÑ Nueva versi√≥n disponible")},onOfflineReady(){console.log("‚úÖ PWA lista para offline")},onRegistered(i){console.log("‚úÖ Service Worker registrado:",i?.scope)},onRegisterError(i){console.error("‚ùå Error en Service Worker:",i)}})}}catch(o){console.warn("‚ö†Ô∏è Error registrando Service Worker:",o)}});let l=x(()=>w().url.pathname),s=x(()=>e(l).startsWith("/ruta")?"ruta":e(l).startsWith("/clientes")?"clientes":e(l).startsWith("/balance")?"balance":e(l).startsWith("/configuracion")?"configuracion":"ruta"),F=x(()=>e(l)==="/clientes/nuevo"||e(l).match(/\/clientes\/[^/]+$/)),T=x(()=>e(l)==="/clientes/nuevo"?"Nuevo Cliente":e(s)==="ruta"?"Mi Ruta":e(s)==="clientes"?"Clientes":e(s)==="balance"?"Balance":e(s)==="configuracion"?"Configuraci√≥n":"Mi Ruta");function K(){e(s)==="clientes"?$("/clientes"):window.history.back()}function b(o){$({ruta:"/ruta",clientes:"/clientes",balance:"/balance",configuracion:"/configuracion"}[o])}async function X(){try{console.log("üö™ Cerrando sesi√≥n..."),await me.signOut()}catch(o){console.error("‚ùå Error al cerrar sesi√≥n:",o)}}var R=ce(),Z=A(R);{var G=o=>{var k=Se(),i=r(k),B=r(i),q=r(B),J=r(q);{var Q=u=>{var h=_e(),_=A(h);_.__click=K;var d=n(_,2),M=r(d,!0);c(d);var ne=n(d,2);L(()=>{P(M,e(T)),g(ne,1,`status-dot ${t()?"online":"offline"}`,"svelte-1v2axqk")}),S(u,h)},ee=u=>{var h=be(),_=n(A(h),2),d=n(_,2),M=r(d,!0);c(d),L(()=>{g(_,1,`status-dot ${t()?"online":"offline"}`,"svelte-1v2axqk"),P(M,e(T))}),S(u,h)};j(J,u=>{e(F)?u(Q):u(ee,!1)})}c(q);var I=n(q,2),oe=r(I);oe.__click=X,c(I),c(B),c(i);var y=n(i,2),ae=r(y);ue(ae,p,"default",{}),c(y);var D=n(y,2),z=r(D);z.__click=()=>b("ruta");var N=n(z,2);N.__click=()=>b("clientes");var Y=n(N,2);Y.__click=()=>b("balance");var V=n(Y,2);V.__click=()=>b("configuracion"),c(D),c(k),L(()=>{g(z,1,`nav-item ${e(s)==="ruta"?"active":""}`,"svelte-1v2axqk"),g(N,1,`nav-item ${e(s)==="clientes"?"active":""}`,"svelte-1v2axqk"),g(Y,1,`nav-item ${e(s)==="balance"?"active":""}`,"svelte-1v2axqk"),g(V,1,`nav-item ${e(s)==="configuracion"?"active":""}`,"svelte-1v2axqk")}),S(o,k)};j(Z,o=>{v()&&o(G)})}S(a,R),le(),U()}se(["click"]);export{Me as component};
